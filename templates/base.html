{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}logisEdge{% endblock %}</title>
    <link rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap-icons.css' %}">
    <style>
        .dropdown-submenu {
            position: relative;
        }
        
        .dropdown-submenu .dropdown-menu {
            position: absolute;
            top: 0;
            left: 100%;
            margin-top: -1px;
            margin-left: 0;
            display: none;
            z-index: 1000;
            min-width: 200px;
            border: 1px solid rgba(0,0,0,.15);
            border-radius: 0.375rem;
            background-color: #fff;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }
        
        .dropdown-submenu:hover > .dropdown-menu {
            display: block;
        }
        
        .dropdown-submenu .dropdown-item {
            white-space: nowrap;
            padding: 0.375rem 1rem;
        }
        
        /* Prevent submenu from going off-screen on the right */
        .dropdown-submenu.dropstart .dropdown-menu {
            left: auto;
            right: 100%;
            margin-left: 0;
            margin-right: 0;
        }
        
        /* Ensure proper positioning on smaller screens */
        @media (max-width: 768px) {
            .dropdown-submenu .dropdown-menu {
                position: static;
                left: auto;
                margin-left: 1rem;
                margin-top: 0;
                box-shadow: none;
                border: none;
                background-color: #f8f9fa;
            }
        }

        /* Professional Dashboard Card Styles */
        .dashboard-card {
            transition: all 0.3s ease;
            border-radius: 12px;
            overflow: hidden;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid rgba(0,0,0,0.05);
            height: 120px;
            min-height: 120px;
        }

        /* Custom grid for 8 cards per row */
        .col-lg-1-5 {
            flex: 0 0 12.5%;
            max-width: 12.5%;
        }

        /* Responsive breakpoints for 8 cards per row */
        @media (max-width: 1200px) {
            .col-lg-1-5 {
                flex: 0 0 16.666667%;
                max-width: 16.666667%;
            }
        }

        @media (max-width: 992px) {
            .col-lg-1-5 {
                flex: 0 0 25%;
                max-width: 25%;
            }
        }

        @media (max-width: 768px) {
            .col-lg-1-5 {
                flex: 0 0 33.333333%;
                max-width: 33.333333%;
            }
        }

        @media (max-width: 576px) {
            .col-lg-1-5 {
                flex: 0 0 50%;
                max-width: 50%;
            }
        }

        .dashboard-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1) !important;
            border-color: rgba(0,0,0,0.1);
        }

        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .hover-lift:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15) !important;
        }

        .icon-wrapper {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .dashboard-card:hover .icon-wrapper {
            transform: scale(1.1);
        }

        .dashboard-card .card-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .dashboard-card .card-text {
            color: #6c757d;
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .dashboard-card a {
            text-decoration: none;
            color: inherit;
        }

        .dashboard-card a:hover {
            text-decoration: none;
            color: inherit;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .dashboard-card {
                margin-bottom: 0.5rem;
            }
            
            .icon-wrapper {
                width: 40px;
                height: 40px;
            }
            
            .dashboard-card .card-title {
                font-size: 0.8rem;
            }

            .dashboard-card .card-text {
                font-size: 0.7rem;
            }
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #1e3a8a;">
  <div class="container-fluid">
    <a class="navbar-brand" href="{% url 'dashboard:dashboard' %}">logisEdge</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-gear me-1"></i>Master
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{% url 'customer:customer_list' %}"><i class="bi bi-person me-2"></i>Customer</a></li>
            <li><a class="dropdown-item" href="{% url 'items:item_list' %}"><i class="bi bi-box me-2"></i>Items</a></li>
            <li><a class="dropdown-item" href="{% url 'port:port_list' %}"><i class="bi bi-geo-alt me-2"></i>Port</a></li>
            <li><a class="dropdown-item" href="{% url 'service:service_list' %}"><i class="bi bi-tools me-2"></i>Service</a></li>
            <li><a class="dropdown-item" href="{% url 'charges:charge_list' %}"><i class="bi bi-currency-dollar me-2"></i>Charges</a></li>

            <li><a class="dropdown-item" href="{% url 'salesman:salesman_list' %}"><i class="bi bi-person-badge me-2"></i>Salesman</a></li>
            <li><a class="dropdown-item" href="{% url 'facility:facility_list' %}"><i class="bi bi-building me-2"></i>Facility</a></li>
            <li><a class="dropdown-item" href="{% url 'payment_source:payment_source_list' %}"><i class="bi bi-credit-card me-2"></i>Payment Sources</a></li>
            <li><hr class="dropdown-divider"></li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false" id="chart-of-accounts-link">
                <i class="bi bi-diagram-3 me-2"></i>Chart of Account
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'chart_of_accounts:account_list' %}"><i class="bi bi-list-ul me-2"></i>Accounts</a></li>
                <li><a class="dropdown-item" href="{% url 'chart_of_accounts:parent_accounts_list' %}"><i class="bi bi-folder me-2"></i>Parent Accounts</a></li>
                <li><a class="dropdown-item" href="{% url 'chart_of_accounts:account_type_list' %}"><i class="bi bi-tags me-2"></i>Account Types</a></li>
                <li><a class="dropdown-item" href="{% url 'chart_of_accounts:dashboard' %}"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
              </ul>
            </li>
            <li><a class="dropdown-item" href="{% url 'ledger:ledger_list' %}"><i class="bi bi-journal-text me-2"></i>Ledger</a></li>
          </ul>
        </li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            📦 Warehouse
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{% url 'quotation:quotation_list' %}"><i class="bi bi-file-earmark-text me-2"></i>Quotation</a></li>
            <li><hr class="dropdown-divider"></li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-arrow-down-circle me-2"></i>Inbound
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'job:job_list' %}"><i class="bi bi-plus-circle me-2"></i>New Job</a></li>
                <li><a class="dropdown-item" href="{% url 'grn:grn_list' %}"><i class="bi bi-receipt me-2"></i>GRN</a></li>
                <li><a class="dropdown-item" href="{% url 'putaways:putaway_list' %}"><i class="bi bi-box-arrow-in-down me-2"></i>Putaways</a></li>
                <li><a class="dropdown-item" href="{% url 'documentation:documentation_list' %}"><i class="bi bi-file-earmark-text me-2"></i>Documentation</a></li>
                <li><a class="dropdown-item" href="{% url 'crossstuffing:crossstuffing_list' %}"><i class="bi bi-arrow-left-right me-2"></i>Cross Stuffing</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-arrow-up-circle me-2"></i>Outbound
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'delivery_order:delivery_order_list' %}"><i class="bi bi-truck me-2"></i>Delivery Order</a></li>
                <li><a class="dropdown-item" href="/outbound/picklist/"><i class="bi bi-list-check me-2"></i>Picklist</a></li>
                <li><a class="dropdown-item" href="{% url 'dispatchnote:dispatch_list' %}"><i class="bi bi-file-earmark-arrow-up me-2"></i>Dispatch Note</a></li>
              </ul>
            </li>
                                    <li><a class="dropdown-item" href="{% url 'stock_transfer:stock_transfer_list' %}"><i class="bi bi-arrow-left-right me-2"></i>Stock Transfer</a></li>
                            <li><a class="dropdown-item" href="{% url 'location_transfer:location_transfer_dashboard' %}"><i class="bi bi-geo-alt me-2"></i>Location Transfer</a></li>
                <li><a class="dropdown-item" href="{% url 'storage_invoice:storage_invoice_list' %}"><i class="bi bi-receipt me-2"></i>Storage Invoice</a></li>
                <li><a class="dropdown-item" href="{% url 'charges:charge_list' %}"><i class="bi bi-currency-dollar me-2"></i>Charges</a></li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-calculator me-2"></i>Invoicing
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'invoice:invoice_list' %}"><i class="bi bi-receipt me-2"></i>Invoice</a></li>
                <li><a class="dropdown-item" href="/invoicing/pro-forma-invoice/"><i class="bi bi-file-earmark-text me-2"></i>Pro-Forma Invoice</a></li>
              </ul>
            </li>
            <li><a class="dropdown-item" href="#"><i class="bi bi-box-seam me-2"></i>LGP</a></li>
          </ul>
        </li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            🚢 Freight
          </a>
          <ul class="dropdown-menu">
                                                                                    <li><a class="dropdown-item" href="{% url 'freight_quotation:quotation_list' %}"><i class="bi bi-file-earmark-text me-2"></i>Freight Quotation</a></li>
                        <li><a class="dropdown-item" href="{% url 'freight_booking:booking_list' %}"><i class="bi bi-calendar-check me-2"></i>Freight Booking</a></li>
                        <li><a class="dropdown-item" href="{% url 'container_management:dashboard' %}"><i class="bi bi-container me-2"></i>Container Management</a></li>
                        <li><a class="dropdown-item" href="{% url 'bill_of_lading:dashboard' %}"><i class="bi bi-file-earmark me-2"></i>Bill of Lading</a></li>
            <li><a class="dropdown-item" href="{% url 'shipment_tracking:dashboard' %}"><i class="bi bi-truck me-2"></i>Tracking & Status Update</a></li>
            <li><a class="dropdown-item" href="#"><i class="bi bi-receipt me-2"></i>Freight Invoice</a></li>
            <li><a class="dropdown-item" href="#"><i class="bi bi-receipt-cutoff me-2"></i>Vendor Freight Bills</a></li>
          </ul>
        </li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-calculator me-1"></i>Accounting
          </a>
          <ul class="dropdown-menu">
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-arrow-down-circle me-2"></i>Accounts Receivable
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'credit_note:list' %}"><i class="bi bi-receipt-cutoff me-2"></i>Credit Notes</a></li>
                <li><a class="dropdown-item" href="{% url 'customer_payments:payment_list' %}"><i class="bi bi-cash me-2"></i>Customer Payments</a></li>
                <li><a class="dropdown-item" href="{% url 'dunning_letters:list' %}"><i class="bi bi-envelope-exclamation me-2"></i>Dunning Letters</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-arrow-up-circle me-2"></i>Accounts Payable
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'supplier_bills:list' %}"><i class="bi bi-receipt me-2"></i>Supplier Bills</a></li>
                <li><a class="dropdown-item" href="{% url 'debit_note:list' %}"><i class="bi bi-receipt-cutoff me-2"></i>Debit Notes</a></li>
                <li><a class="dropdown-item" href="{% url 'supplier_payments:supplier_payment_list' %}"><i class="bi bi-cash-stack me-2"></i>Supplier Payments</a></li>
                <li><a class="dropdown-item" href="/accounting/payment-scheduling/"><i class="bi bi-calendar-check me-2"></i>Payment Scheduling</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-journal-text me-2"></i>Journals & Vouchers
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'general_journal:journal_list' %}"><i class="bi bi-journal me-2"></i>General Journal</a></li>
                <li><a class="dropdown-item" href="/accounting/payment-voucher/"><i class="bi bi-cash me-2"></i>Payment Voucher</a></li>
                <li><a class="dropdown-item" href="/accounting/receipt-voucher/"><i class="bi bi-receipt me-2"></i>Receipt Voucher</a></li>
                <li><a class="dropdown-item" href="/accounting/contra-entry/"><i class="bi bi-arrow-left-right me-2"></i>Contra Entry</a></li>
                <li><a class="dropdown-item" href="/accounting/adjustment-entries/"><i class="bi bi-gear me-2"></i>Adjustment Entries</a></li>
                <li><a class="dropdown-item" href="/accounting/opening-balances/"><i class="bi bi-currency-exchange me-2"></i>Opening Balances</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-arrow-repeat me-2"></i>Transactions
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/accounting/all-transactions/"><i class="bi bi-list-ul me-2"></i>All Transactions View</a></li>
                <li><a class="dropdown-item" href="/accounting/cash-transactions/"><i class="bi bi-bank me-2"></i>Cash Transactions</a></li>
                <li><a class="dropdown-item" href="/accounting/petty-cash/"><i class="bi bi-wallet2 me-2"></i>Petty Cash</a></li>
                <li><a class="dropdown-item" href="/accounting/manual-journal-entry/"><i class="bi bi-pencil-square me-2"></i>Manual Journal Entry</a></li>
                <li><a class="dropdown-item" href="/accounting/recurring-entries/"><i class="bi bi-arrow-clockwise me-2"></i>Recurring Entries</a></li>
                <li><a class="dropdown-item" href="/accounting/billing-payable-tracking/"><i class="bi bi-clipboard-check me-2"></i>Billing/Payable Tracking</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-bank me-2"></i>Banking
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/accounting/bank-accounts/"><i class="bi bi-credit-card me-2"></i>Bank Accounts</a></li>
                <li><a class="dropdown-item" href="/accounting/bank-reconciliation/"><i class="bi bi-check2-square me-2"></i>Bank Reconciliation</a></li>
                <li><a class="dropdown-item" href="/accounting/cheque-register/"><i class="bi bi-receipt me-2"></i>Cheque Register</a></li>
                <li><a class="dropdown-item" href="/accounting/deposit-slips/"><i class="bi bi-cash-stack me-2"></i>Deposit Slips</a></li>
                <li><a class="dropdown-item" href="/accounting/bank-transfers/"><i class="bi bi-arrow-left-right me-2"></i>Bank Transfers</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-percent me-2"></i>Taxation
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'tax_settings:dashboard' %}"><i class="bi bi-gear me-2"></i>Tax Settings (VAT)</a></li>
                <li><a class="dropdown-item" href="{% url 'tax_invoice:dashboard' %}"><i class="bi bi-receipt me-2"></i>Tax Invoices</a></li>
                <li><a class="dropdown-item" href="{% url 'tax_summary:dashboard' %}"><i class="bi bi-graph-up me-2"></i>Input/Output Tax Summary</a></li>
                <li><a class="dropdown-item" href="{% url 'tax_filing:dashboard' %}"><i class="bi bi-file-earmark-text me-2"></i>Tax Filing Report</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-building me-2"></i>Assets Management
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/accounting/asset-register/"><i class="bi bi-list-ul me-2"></i>Asset Register</a></li>
                <li><a class="dropdown-item" href="/accounting/dispose-asset/"><i class="bi bi-trash me-2"></i>Dispose Asset</a></li>
                <li><a class="dropdown-item" href="{% url 'depreciation_schedule:dashboard' %}"><i class="bi bi-calendar-range me-2"></i>Depreciation Schedule</a></li>
                <li><a class="dropdown-item" href="{% url 'asset_movement_log:dashboard' %}"><i class="bi bi-arrow-left-right me-2"></i>Asset Movement Log</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-diagram-3 me-2"></i>Cost Centers
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/accounting/define-cost-centers/"><i class="bi bi-gear me-2"></i>Define Cost Centers</a></li>
                <li><a class="dropdown-item" href="/accounting/assign-transactions/"><i class="bi bi-link me-2"></i>Assign Transactions</a></li>
                <li><a class="dropdown-item" href="/accounting/cost-center-reports/"><i class="bi bi-graph-up me-2"></i>Cost Center Reports</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-graph-up me-2"></i>Budgets & Forecasting
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/accounting/budget-planning/"><i class="bi bi-calendar-plus me-2"></i>Budget Planning</a></li>
                <li><a class="dropdown-item" href="/accounting/budget-vs-actual/"><i class="bi bi-bar-chart me-2"></i>Budget vs Actual Comparison</a></li>
                <li><a class="dropdown-item" href="/accounting/variance-reports/"><i class="bi bi-exclamation-triangle me-2"></i>Variance Reports</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-people me-1"></i>HR
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{% url 'employees:dashboard' %}"><i class="bi bi-person-badge me-2"></i>Employee Management</a></li>
            <li><a class="dropdown-item" href="{% url 'attendance:dashboard' %}"><i class="bi bi-clock me-2"></i>Attendance & Time Tracking</a></li>
                                    <li><a class="dropdown-item" href="{% url 'leave_management:dashboard' %}"><i class="bi bi-calendar-check me-2"></i>Leave Management</a></li>
                        <li><a class="dropdown-item" href="{% url 'payroll:dashboard' %}"><i class="bi bi-cash-stack me-2"></i>Payroll</a></li>
            <li><a class="dropdown-item" href="{% url 'recruitment:dashboard' %}"><i class="bi bi-person-plus me-2"></i>Recruitment</a></li>
            <li><a class="dropdown-item" href="/hr/disciplinary-grievance/"><i class="bi bi-exclamation-triangle me-2"></i>Disciplinary & Grievance</a></li>
            <li><a class="dropdown-item" href="/hr/letters-documents/"><i class="bi bi-file-earmark-text me-2"></i>HR Letters & Documents</a></li>
            <li><a class="dropdown-item" href="/hr/exit-management/"><i class="bi bi-box-arrow-right me-2"></i>Exit Management</a></li>
          </ul>
        </li>
       
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-shield-check me-1"></i>Admin
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="{% url 'company:company_list' %}"><i class="bi bi-building me-2"></i>Company</a></li>
            <li><a class="dropdown-item" href="{% url 'user:user_list' %}"><i class="bi bi-people me-2"></i>User</a></li>
            <li><a class="dropdown-item" href="{% url 'user:permissions_management' %}"><i class="bi bi-shield-lock me-2"></i>Permissions Management</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-gear me-1"></i>Settings
          </a>
          <ul class="dropdown-menu">
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-calculator me-2"></i>Financial Settings
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'fiscal_year:dashboard' %}"><i class="bi bi-calendar-range me-2"></i>Fiscal Year Settings</a></li>
                <li><a class="dropdown-item" href="{% url 'multi_currency:dashboard' %}"><i class="bi bi-currency-exchange me-2"></i>Multi-Currency Setup</a></li>
                <li><a class="dropdown-item" href="/settings/approval-workflows/"><i class="bi bi-diagram-3 me-2"></i>Approval Workflows</a></li>
                <li><a class="dropdown-item" href="/settings/roles-permissions/"><i class="bi bi-shield-check me-2"></i>Roles & Permissions</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-tools me-1"></i>Utilities
          </a>
          <ul class="dropdown-menu">
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-database me-2"></i>Data Tools
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/utilities/import-master-data/"><i class="bi bi-upload me-2"></i>Import Master Data (CSV/Excel)</a></li>
                <li><a class="dropdown-item" href="/utilities/bulk-export/"><i class="bi bi-download me-2"></i>Bulk Export (Customers, Items, Transactions)</a></li>
                <li><a class="dropdown-item" href="/utilities/data-cleaning/"><i class="bi bi-brush me-2"></i>Data Cleaning Tool</a></li>
                <li><a class="dropdown-item" href="/utilities/merge-duplicates/"><i class="bi bi-link me-2"></i>Merge Duplicates</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-cloud-arrow-up me-2"></i>Backup & Restore
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/utilities/manual-backup/"><i class="bi bi-cloud-upload me-2"></i>Manual Backup</a></li>
                <li><a class="dropdown-item" href="/utilities/backup-scheduler/"><i class="bi bi-calendar-check me-2"></i>Backup Scheduler</a></li>
                <li><a class="dropdown-item" href="/utilities/backup-scheduler/restore/"><i class="bi bi-cloud-download me-2"></i>Data Restore Option</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-journal-text me-2"></i>Logs & Reports
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/utilities/activity-logs/"><i class="bi bi-activity me-2"></i>Activity Logs / Audit Trail</a></li>
                <li><a class="dropdown-item" href="/utilities/log-history/"><i class="bi bi-person-check me-2"></i>Log History</a></li>
                <li><a class="dropdown-item" href="/utilities/system-errors/"><i class="bi bi-exclamation-triangle me-2"></i>System Errors / Debug Logs</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-envelope me-2"></i>Email & SMS Tools
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/utilities/email-configuration/"><i class="bi bi-envelope-check me-2"></i>Email Configuration Test</a></li>
                <li><a class="dropdown-item" href="/utilities/sms-gateway-tester/"><i class="bi bi-phone me-2"></i>SMS Gateway Tester</a></li>
                <li><a class="dropdown-item" href="/utilities/bulk-email-sender/"><i class="bi bi-envelope-paper me-2"></i>Bulk Email Sender</a></li>
                <li><a class="dropdown-item" href="/utilities/notification-templates/"><i class="bi bi-file-earmark-text me-2"></i>Notification Templates</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-file-earmark-text me-2"></i>Document Tools
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/utilities/print-queue/"><i class="bi bi-printer me-2"></i>Print Queue Management</a></li>
                <li><a class="dropdown-item" href="/utilities/pdf-preview/"><i class="bi bi-eye me-2"></i>PDF Preview Tool</a></li>
                <li><a class="dropdown-item" href="/utilities/signature-stamp/"><i class="bi bi-stamp me-2"></i>Signature / Stamp Uploader</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-clock me-2"></i>Scheduler & Automation
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/utilities/auto-task-scheduler/"><i class="bi bi-calendar-plus me-2"></i>Auto Task Scheduler</a></li>
                <li><a class="dropdown-item" href="/utilities/cron-job-viewer/"><i class="bi bi-list-task me-2"></i>Cron Job Viewer</a></li>
                <li><a class="dropdown-item" href="/utilities/background-job-monitor/"><i class="bi bi-display me-2"></i>Background Job Monitor</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-code-slash me-2"></i>Developer / Admin Tools
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/utilities/custom-field-builder/"><i class="bi bi-puzzle me-2"></i>Custom Field Builder</a></li>
                <li><a class="dropdown-item" href="/utilities/api-tokens/"><i class="bi bi-key me-2"></i>API Tokens / Keys</a></li>
                <li><a class="dropdown-item" href="/utilities/webhooks-manager/"><i class="bi bi-link-45deg me-2"></i>Webhooks Manager</a></li>
                <li><a class="dropdown-item" href="/utilities/system-health-check/"><i class="bi bi-heart-pulse me-2"></i>System Health Check</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-graph-up me-1"></i>Reports
          </a>
          <ul class="dropdown-menu">
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-list-ul me-2"></i>Master Reports
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/reports/item-master-list/"><i class="bi bi-box me-2"></i>Item Master List</a></li>
                <li><a class="dropdown-item" href="/reports/item-category-summary/"><i class="bi bi-diagram-3 me-2"></i>Item Category Summary</a></li>
                <li><a class="dropdown-item" href="/reports/customer-supplier-master/"><i class="bi bi-people me-2"></i>Customer & Supplier Master Report</a></li>
                <li><a class="dropdown-item" href="/reports/units-of-measure/"><i class="bi bi-rulers me-2"></i>Units of Measure Report</a></li>
                <li><a class="dropdown-item" href="/reports/tax-rules-summary/"><i class="bi bi-percent me-2"></i>Tax Rules Summary</a></li>
                <li><a class="dropdown-item" href="/reports/master-data-audit/"><i class="bi bi-journal-check me-2"></i>Master Data Audit Log</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-warehouse me-2"></i>Warehouse Reports
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/reports/stock-ledger/"><i class="bi bi-journal-text me-2"></i>Stock Ledger Report</a></li>
                <li><a class="dropdown-item" href="/reports/stock-movement/"><i class="bi bi-arrow-left-right me-2"></i>Stock Movement Report (In/Out/Transfers)</a></li>
                <li><a class="dropdown-item" href="/reports/reorder-level-breach/"><i class="bi bi-exclamation-triangle me-2"></i>Reorder Level Breach Report</a></li>
                <li><a class="dropdown-item" href="/reports/bin-location-stock/"><i class="bi bi-geo-alt me-2"></i>Bin/Location-wise Stock</a></li>
                <li><a class="dropdown-item" href="/reports/inventory-aging/"><i class="bi bi-clock-history me-2"></i>Inventory Aging Report</a></li>
                <li><a class="dropdown-item" href="/reports/item-expiry/"><i class="bi bi-calendar-x me-2"></i>Item Expiry Report (if applicable)</a></li>
                <li><a class="dropdown-item" href="/reports/stock-valuation/"><i class="bi bi-calculator me-2"></i>Stock Valuation Report (FIFO/LIFO)</a></li>
                <li><a class="dropdown-item" href="/reports/customs-boe-stock/"><i class="bi bi-file-earmark-check me-2"></i>Customs BOE Stock</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-truck me-2"></i>Freight Reports
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/reports/freight-cost-analysis/"><i class="bi bi-graph-up me-2"></i>Freight Cost Analysis (Per Job / Shipment)</a></li>
                <li><a class="dropdown-item" href="/reports/container-movement/"><i class="bi bi-box-seam me-2"></i>Container Movement Report</a></li>
                <li><a class="dropdown-item" href="/reports/delivery-order-summary/"><i class="bi bi-clipboard-data me-2"></i>Delivery Order Summary</a></li>
                <li><a class="dropdown-item" href="/reports/driver-vehicle-utilization/"><i class="bi bi-person-badge me-2"></i>Driver/Vehicle Utilization</a></li>
                <li><a class="dropdown-item" href="/reports/route-performance/"><i class="bi bi-map me-2"></i>Route Performance Report</a></li>
                <li><a class="dropdown-item" href="/reports/freight-invoice-summary/"><i class="bi bi-receipt me-2"></i>Freight Invoice Summary</a></li>
                <li><a class="dropdown-item" href="/reports/customs-tariff-charge/"><i class="bi bi-file-earmark-text me-2"></i>Customs / Tariff Charge Report</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-calculator me-2"></i>Accounting Reports
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="{% url 'trial_balance:trial_balance_report' %}"><i class="bi bi-scale me-2"></i>Trial Balance</a></li>
                <li><a class="dropdown-item" href="{% url 'profit_loss_statement:profit_loss_report' %}"><i class="bi bi-graph-up-arrow me-2"></i>Profit & Loss Statement</a></li>
                <li><a class="dropdown-item" href="{% url 'partner_ledger:report' %}"><i class="bi bi-people me-2"></i>Partner Ledger</a></li>
                <li><a class="dropdown-item" href="{% url 'vendor_ledger:vendor_ledger_report' %}"><i class="bi bi-truck me-2"></i>Vendor Ledger Report</a></li>
                <li><a class="dropdown-item" href="{% url 'general_ledger_report:report_list' %}"><i class="bi bi-journal-text me-2"></i>General Ledger</a></li>
                <li><a class="dropdown-item" href="{% url 'source_payment_ledger:report' %}"><i class="bi bi-credit-card me-2"></i>Source Payment Ledger</a></li>

                <li><a class="dropdown-item" href="{% url 'balance_sheet:balance_sheet_report' %}"><i class="bi bi-file-earmark-spreadsheet me-2"></i>Balance Sheet</a></li>
                <li><a class="dropdown-item" href="/reports/cash-flow/"><i class="bi bi-cash-stack me-2"></i>Cash Flow Statement</a></li>
                <li><a class="dropdown-item" href="/reports/accounts-receivable-aging/"><i class="bi bi-clock me-2"></i>Accounts Receivable Aging</a></li>
                <li><a class="dropdown-item" href="/reports/accounts-payable-aging/"><i class="bi bi-clock-history me-2"></i>Accounts Payable Aging</a></li>
                <li><a class="dropdown-item" href="/reports/tax-summary/"><i class="bi bi-percent me-2"></i>Tax Summary (VAT/GST)</a></li>
                <li><a class="dropdown-item" href="/reports/journal-voucher-register/"><i class="bi bi-journal me-2"></i>Journal Voucher Register</a></li>
                <li><a class="dropdown-item" href="/reports/payment-receipt-report/"><i class="bi bi-arrow-left-right me-2"></i>Payment & Receipt Report</a></li>
                <li><a class="dropdown-item" href="/reports/budget-vs-actual/"><i class="bi bi-bar-chart me-2"></i>Budget vs Actual Report</a></li>
                <li><a class="dropdown-item" href="/reports/bank-reconciliation-report/"><i class="bi bi-bank me-2"></i>Bank Reconciliation Report</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
              <a class="dropdown-item dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-people me-2"></i>HR Reports
              </a>
              <ul class="dropdown-menu dropdown-submenu">
                <li><a class="dropdown-item" href="/reports/employee-list/"><i class="bi bi-person-lines-fill me-2"></i>Employee List Report</a></li>
                <li><a class="dropdown-item" href="/reports/attendance-register/"><i class="bi bi-calendar-check me-2"></i>Attendance Register</a></li>
                <li><a class="dropdown-item" href="/reports/leave-balance-summary/"><i class="bi bi-calendar-minus me-2"></i>Leave Balance Summary</a></li>
                <li><a class="dropdown-item" href="/reports/monthly-salary-report/"><i class="bi bi-cash me-2"></i>Monthly Salary Report</a></li>
                <li><a class="dropdown-item" href="/reports/payroll-register/"><i class="bi bi-journal-text me-2"></i>Payroll Register</a></li>
                <li><a class="dropdown-item" href="/reports/bonus-deductions-report/"><i class="bi bi-plus-slash-minus me-2"></i>Bonus/Deductions Report</a></li>
                <li><a class="dropdown-item" href="/reports/department-headcount/"><i class="bi bi-building me-2"></i>Department-wise Headcount</a></li>
                <li><a class="dropdown-item" href="/reports/appraisal-history/"><i class="bi bi-star me-2"></i>Appraisal History</a></li>
                <li><a class="dropdown-item" href="/reports/exit-summary-report/"><i class="bi bi-box-arrow-right me-2"></i>Exit Summary Report</a></li>
                <li><a class="dropdown-item" href="/reports/employee-turnover-analysis/"><i class="bi bi-graph-down me-2"></i>Employee Turnover Analysis</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
      <div class="navbar-nav">
        <span class="navbar-text me-3">
          <i class="bi bi-person-circle"></i> 
          {% if user and user.is_authenticated %}
            {{ user.get_full_name|default:user.username|default:"User" }}
          {% else %}
            Guest
          {% endif %}
        </span>
        <form method="post" action="{% url 'logout' %}" style="display: inline;">
          {% csrf_token %}
          <button type="submit" class="btn btn-outline-light btn-sm">
            <i class="bi bi-box-arrow-right"></i> Logout
          </button>
        </form>
      </div>
    </div>
  </div>
</nav>

{% block content %}{% endblock %}

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>

{% block extra_js %}{% endblock %}
<script>
// Enhanced dropdown menu functionality - Updated: 2025-08-14
document.addEventListener('DOMContentLoaded', function() {
    console.log('Page loaded, initializing enhanced dropdown functionality...');
    
    // Initialize Bootstrap dropdowns
    if (typeof bootstrap !== 'undefined') {
        console.log('✅ Bootstrap is loaded');
        
        // Initialize all dropdowns
        const dropdownElementList = document.querySelectorAll('.dropdown-toggle');
        const dropdownList = [...dropdownElementList].map(dropdownToggleEl => new bootstrap.Dropdown(dropdownToggleEl));
        console.log(`✅ Initialized ${dropdownList.length} dropdowns`);
        
        // Handle nested dropdowns (Chart of Accounts)
        const nestedDropdowns = document.querySelectorAll('.dropdown-submenu');
        nestedDropdowns.forEach(function(nestedDropdown) {
            const dropdownToggle = nestedDropdown.querySelector('.dropdown-toggle');
            if (dropdownToggle) {
                dropdownToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Toggle the nested dropdown
                    const dropdownMenu = nestedDropdown.querySelector('.dropdown-menu');
                    if (dropdownMenu) {
                        dropdownMenu.classList.toggle('show');
                    }
                });
            }
        });
        
    } else {
        console.log('❌ Bootstrap is not loaded');
    }
    
    // Enhanced click event listeners for all dropdown items
    const dropdownItems = document.querySelectorAll('.dropdown-item');
    dropdownItems.forEach(function(item, index) {
        item.addEventListener('click', function(e) {
            // If it's a nested dropdown toggle, don't navigate
            if (this.classList.contains('dropdown-toggle')) {
                e.preventDefault();
                e.stopPropagation();
                return;
            }
            
            // For regular items with valid hrefs, allow navigation
            if (this.href && this.href !== '#' && !this.href.endsWith('#')) {
                // Allow default navigation behavior
            } else {
                e.preventDefault();
            }
        });
    });
    
    // Test dropdown functionality
    const masterDropdown = document.querySelector('.nav-item.dropdown');
    if (masterDropdown) {
        console.log('✅ Master dropdown found');
        const dropdownMenu = masterDropdown.querySelector('.dropdown-menu');
        if (dropdownMenu) {
            console.log('✅ Dropdown menu found');
            
            // Test dropdown toggle
            const dropdownToggle = masterDropdown.querySelector('.dropdown-toggle');
            if (dropdownToggle) {
                dropdownToggle.addEventListener('click', function(e) {
                    console.log('🎯 Master dropdown toggle clicked');
                });
            }
        } else {
            console.log('❌ Dropdown menu not found');
        }
    } else {
        console.log('❌ Master dropdown not found');
    }
    
    // Test Payment Sources link specifically
    const paymentSourceLink = document.querySelector('a[href*="payment-source"]');
    if (paymentSourceLink) {
        console.log('✅ Payment Sources link found:', paymentSourceLink.href);
        paymentSourceLink.addEventListener('click', function(e) {
            console.log('🎯 Payment Sources link clicked!');
        });
    } else {
        console.log('❌ Payment Sources link not found');
    }
    
    // Handle submenu positioning to prevent overlapping
    const submenus = document.querySelectorAll('.dropdown-submenu');
    submenus.forEach(function(submenu) {
        const submenuDropdown = submenu.querySelector('.dropdown-menu');
        if (submenuDropdown) {
            submenu.addEventListener('mouseenter', function() {
                // Check if submenu would go off-screen
                const rect = submenu.getBoundingClientRect();
                const submenuRect = submenuDropdown.getBoundingClientRect();
                const windowWidth = window.innerWidth;
                
                // If submenu would go off-screen on the right, position it to the left
                if (rect.right + submenuRect.width > windowWidth) {
                    submenu.classList.add('dropstart');
                } else {
                    submenu.classList.remove('dropstart');
                }
                
                // Show the submenu
                submenuDropdown.style.display = 'block';
            });
            
            submenu.addEventListener('mouseleave', function() {
                // Hide the submenu
                submenuDropdown.style.display = 'none';
            });
        }
    });
    
    console.log('🚀 Enhanced dropdown functionality initialized successfully');
});
</script>

</body>
</html>
