{% extends 'base.html' %}
{% load static %}

{% block title %}{{ title }} - LogisEdge{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'receipt_voucher/css/receipt_voucher.css' %}">
{% endblock %}

{% block content %}
<div class="receipt-voucher-container">
    <div class="receipt-voucher-card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2>{{ title }}</h2>
            <a href="{% url 'receipt_voucher:receipt_voucher_list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to List
            </a>
        </div>

        <form method="post" class="receipt-voucher-form" enctype="multipart/form-data">
            {% csrf_token %}
            
            <!-- Basic Information Section -->
            <div class="form-group">
                <label for="{{ form.voucher_date.id_for_label }}">Voucher Date *</label>
                {{ form.voucher_date }}
                {% if form.voucher_date.errors %}
                <div class="invalid-feedback">{{ form.voucher_date.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.receipt_mode.id_for_label }}">Receipt Mode *</label>
                {{ form.receipt_mode }}
                {% if form.receipt_mode.errors %}
                <div class="invalid-feedback">{{ form.receipt_mode.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.reference_number.id_for_label }}">Reference Number</label>
                {{ form.reference_number }}
                {% if form.reference_number.errors %}
                <div class="invalid-feedback">{{ form.reference_number.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Payer Information Section -->
            <div class="form-group">
                <label for="{{ form.payer_type.id_for_label }}">Payer Type *</label>
                {{ form.payer_type }}
                {% if form.payer_type.errors %}
                <div class="invalid-feedback">{{ form.payer_type.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.payer_name.id_for_label }}">Payer Name *</label>
                {{ form.payer_name }}
                {% if form.payer_name.errors %}
                <div class="invalid-feedback">{{ form.payer_name.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.payer_code.id_for_label }}">Payer Code</label>
                {{ form.payer_code }}
                {% if form.payer_code.errors %}
                <div class="invalid-feedback">{{ form.payer_code.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.payer_contact.id_for_label }}">Contact Number</label>
                {{ form.payer_contact }}
                {% if form.payer_contact.errors %}
                <div class="invalid-feedback">{{ form.payer_contact.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.payer_email.id_for_label }}">Email Address</label>
                {{ form.payer_email }}
                {% if form.payer_email.errors %}
                <div class="invalid-feedback">{{ form.payer_email.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Financial Information Section -->
            <div class="form-group amount-field">
                <label for="{{ form.amount.id_for_label }}">Amount *</label>
                {{ form.amount }}
                {% if form.amount.errors %}
                <div class="invalid-feedback">{{ form.amount.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.currency.id_for_label }}">Currency *</label>
                {{ form.currency }}
                {% if form.currency.errors %}
                <div class="invalid-feedback">{{ form.currency.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.account_to_credit.id_for_label }}">Account to Credit *</label>
                {{ form.account_to_credit }}
                {% if form.account_to_credit.errors %}
                <div class="invalid-feedback">{{ form.account_to_credit.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Additional Information Section -->
            <div class="form-group full-width">
                <label for="{{ form.description.id_for_label }}">Description / Remarks</label>
                {{ form.description }}
                {% if form.description.errors %}
                <div class="invalid-feedback">{{ form.description.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group full-width">
                <label for="{{ form.reference_invoices.id_for_label }}">Reference Invoice(s)</label>
                {{ form.reference_invoices }}
                <small class="form-text text-muted">{{ form.reference_invoices.help_text }}</small>
                {% if form.reference_invoices.errors %}
                <div class="invalid-feedback">{{ form.reference_invoices.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Form Actions -->
            <div class="form-group full-width" style="margin-top: 30px; text-align: center;">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> {{ submit_text }}
                </button>
                <a href="{% url 'receipt_voucher:receipt_voucher_list' %}" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Cancel
                </a>
            </div>
        </form>
    </div>

    <!-- Help Section -->
    <div class="receipt-voucher-card">
        <h3>Help & Guidelines</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            <div>
                <h4><i class="fas fa-info-circle text-primary"></i> Receipt Modes</h4>
                <ul>
                    <li><strong>Cash:</strong> Physical cash payment</li>
                    <li><strong>Bank Transfer:</strong> Electronic bank transfer</li>
                    <li><strong>Cheque:</strong> Bank cheque payment</li>
                    <li><strong>Credit Card:</strong> Credit card transaction</li>
                    <li><strong>Online Payment:</strong> Digital payment platforms</li>
                    <li><strong>Other:</strong> Any other payment method</li>
                </ul>
            </div>
            <div>
                <h4><i class="fas fa-users text-success"></i> Payer Types</h4>
                <ul>
                    <li><strong>Customer:</strong> Business customers</li>
                    <li><strong>Employee:</strong> Company employees</li>
                    <li><strong>Vendor:</strong> Suppliers and vendors</li>
                    <li><strong>Other:</strong> Any other entity</li>
                </ul>
            </div>
            <div>
                <h4><i class="fas fa-exclamation-triangle text-warning"></i> Important Notes</h4>
                <ul>
                    <li>Voucher numbers are auto-generated</li>
                    <li>Only draft vouchers can be edited</li>
                    <li>Amount must be greater than zero</li>
                    <li>Voucher date cannot be in the future</li>
                    <li>Reference invoices should be comma-separated</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'receipt_voucher/js/receipt_voucher.js' %}"></script>
<script>
    // Initialize form with current values
    document.addEventListener('DOMContentLoaded', function() {
        // Set currency for amount field
        const currencySelect = document.getElementById('id_currency');
        if (currencySelect) {
            const amountField = document.getElementById('id_amount');
            if (amountField) {
                amountField.setAttribute('data-currency', currencySelect.value);
            }
        }

        // Set payer type for autocomplete
        const payerTypeSelect = document.getElementById('id_payer_type');
        if (payerTypeSelect) {
            const payerNameField = document.getElementById('id_payer_name');
            if (payerNameField) {
                switch (payerTypeSelect.value) {
                    case 'customer':
                        payerNameField.placeholder = 'Enter customer name';
                        break;
                    case 'employee':
                        payerNameField.placeholder = 'Enter employee name';
                        break;
                    case 'vendor':
                        payerNameField.placeholder = 'Enter vendor name';
                        break;
                    case 'other':
                        payerNameField.placeholder = 'Enter payer name';
                        break;
                }
            }
        }
    });
</script>
{% endblock %} 