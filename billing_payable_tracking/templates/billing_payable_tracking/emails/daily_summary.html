<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Billing Summary Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            padding: 25px;
            text-align: center;
            border-radius: 8px 8px 0 0;
        }
        .content {
            background: #f9fafb;
            padding: 30px;
            border: 1px solid #e5e7eb;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #6366f1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #6366f1;
            display: block;
        }
        .stat-label {
            color: #6b7280;
            font-size: 0.9em;
            margin-top: 5px;
        }
        .urgent-stat {
            border-left-color: #dc2626;
        }
        .urgent-stat .stat-number {
            color: #dc2626;
        }
        .warning-stat {
            border-left-color: #f59e0b;
        }
        .warning-stat .stat-number {
            color: #f59e0b;
        }
        .success-stat {
            border-left-color: #10b981;
        }
        .success-stat .stat-number {
            color: #10b981;
        }
        .section {
            margin: 30px 0;
        }
        .section-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #374151;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e5e7eb;
        }
        .bill-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .bill-table th {
            background: #f3f4f6;
            padding: 12px;
            text-align: left;
            font-weight: bold;
            color: #374151;
        }
        .bill-table td {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
        }
        .bill-table tr:hover {
            background: #f9fafb;
        }
        .amount {
            font-weight: bold;
            color: #6366f1;
        }
        .overdue {
            color: #dc2626;
            font-weight: bold;
        }
        .due-today {
            color: #f59e0b;
            font-weight: bold;
        }
        .footer {
            background: #f3f4f6;
            padding: 20px;
            text-align: center;
            color: #6b7280;
            font-size: 0.9em;
            border-radius: 0 0 8px 8px;
        }
        .no-data {
            text-align: center;
            color: #6b7280;
            font-style: italic;
            padding: 20px;
        }
        .summary-highlight {
            background: #dbeafe;
            border: 1px solid #93c5fd;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä Daily Billing Summary Report</h1>
        <p>{{ date|date:"F d, Y" }}</p>
    </div>
    
    <div class="content">
        <p>Good morning {{ admin.first_name|default:admin.username }},</p>
        
        <p>Here's your daily billing summary for {{ date|date:"F d, Y" }}:</p>
        
        <!-- Statistics Overview -->
        <div class="section">
            <h2 class="section-title">üìà Key Statistics</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number">{{ stats.total_bills }}</span>
                    <div class="stat-label">Total Bills</div>
                </div>
                <div class="stat-card warning-stat">
                    <span class="stat-number">{{ stats.pending_bills }}</span>
                    <div class="stat-label">Pending Bills</div>
                </div>
                <div class="stat-card urgent-stat">
                    <span class="stat-number">{{ stats.overdue_bills }}</span>
                    <div class="stat-label">Overdue Bills</div>
                </div>
                <div class="stat-card warning-stat">
                    <span class="stat-number">{{ stats.due_today }}</span>
                    <div class="stat-label">Due Today</div>
                </div>
                <div class="stat-card">
                    <span class="stat-number">{{ stats.due_this_week }}</span>
                    <div class="stat-label">Due This Week</div>
                </div>
                <div class="stat-card success-stat">
                    <span class="stat-number">{{ stats.bills_paid_yesterday }}</span>
                    <div class="stat-label">Paid Yesterday</div>
                </div>
            </div>
        </div>
        
        <!-- Daily Activity Summary -->
        {% if stats.bills_created_yesterday > 0 or stats.bills_paid_yesterday > 0 %}
        <div class="summary-highlight">
            <h3>üìã Yesterday's Activity</h3>
            <ul>
                <li><strong>{{ stats.bills_created_yesterday }}</strong> new bill{{ stats.bills_created_yesterday|pluralize }} created</li>
                <li><strong>{{ stats.bills_paid_yesterday }}</strong> bill{{ stats.bills_paid_yesterday|pluralize }} marked as paid</li>
            </ul>
        </div>
        {% endif %}
        
        <!-- Overdue Bills -->
        <div class="section">
            <h2 class="section-title">üö® Overdue Bills ({{ stats.overdue_bills }})</h2>
            {% if recent_overdue %}
                <table class="bill-table">
                    <thead>
                        <tr>
                            <th>Bill No.</th>
                            <th>Vendor</th>
                            <th>Amount</th>
                            <th>Due Date</th>
                            <th>Days Overdue</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for bill in recent_overdue %}
                        <tr>
                            <td>{{ bill.bill_no }}</td>
                            <td>{{ bill.vendor.name }}</td>
                            <td class="amount">${{ bill.amount|floatformat:2 }}</td>
                            <td class="overdue">{{ bill.due_date|date:"M d, Y" }}</td>
                            <td class="overdue">{{ bill.due_date|timesince }} ago</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% if stats.overdue_bills > recent_overdue|length %}
                <p class="no-data">... and {{ stats.overdue_bills|add:"-10" }} more overdue bill{{ stats.overdue_bills|add:"-10"|pluralize }}</p>
                {% endif %}
            {% else %}
                <div class="no-data">‚úÖ No overdue bills - Great job!</div>
            {% endif %}
        </div>
        
        <!-- Bills Due Today -->
        <div class="section">
            <h2 class="section-title">‚è∞ Bills Due Today ({{ stats.due_today }})</h2>
            {% if due_today %}
                <table class="bill-table">
                    <thead>
                        <tr>
                            <th>Bill No.</th>
                            <th>Vendor</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Payment Terms</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for bill in due_today %}
                        <tr>
                            <td>{{ bill.bill_no }}</td>
                            <td>{{ bill.vendor.name }}</td>
                            <td class="amount">${{ bill.amount|floatformat:2 }}</td>
                            <td class="due-today">{{ bill.get_status_display }}</td>
                            <td>{{ bill.payment_terms }} days</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% if stats.due_today > due_today|length %}
                <p class="no-data">... and {{ stats.due_today|add:"-10" }} more bill{{ stats.due_today|add:"-10"|pluralize }} due today</p>
                {% endif %}
            {% else %}
                <div class="no-data">‚úÖ No bills due today</div>
            {% endif %}
        </div>
        
        <!-- Action Items -->
        <div class="section">
            <h2 class="section-title">üìã Recommended Actions</h2>
            <ul>
                {% if stats.overdue_bills > 0 %}
                <li class="overdue">üö® <strong>Priority:</strong> Review and process {{ stats.overdue_bills }} overdue bill{{ stats.overdue_bills|pluralize }}</li>
                {% endif %}
                {% if stats.due_today > 0 %}
                <li class="due-today">‚è∞ <strong>Today:</strong> Process {{ stats.due_today }} bill{{ stats.due_today|pluralize }} due today</li>
                {% endif %}
                {% if stats.due_this_week > 0 %}
                <li>üìÖ <strong>This Week:</strong> Prepare for {{ stats.due_this_week }} bill{{ stats.due_this_week|pluralize }} due within 7 days</li>
                {% endif %}
                {% if stats.pending_bills > 10 %}
                <li>üìù <strong>Review:</strong> {{ stats.pending_bills }} pending bills may need attention</li>
                {% endif %}
                {% if stats.overdue_bills == 0 and stats.due_today == 0 %}
                <li class="success-stat">‚úÖ <strong>Great!</strong> No urgent payment actions required today</li>
                {% endif %}
            </ul>
        </div>
        
        <div class="summary-highlight">
            <p><strong>üí° Quick Access:</strong> Visit the <a href="/accounting/billing-payable-tracking/">Billing Dashboard</a> to manage bills and view detailed reports.</p>
        </div>
        
        <p>This automated report helps you stay on top of your billing obligations and maintain good vendor relationships.</p>
        
        <p>Best regards,<br>
        LogisEdge Billing System</p>
    </div>
    
    <div class="footer">
        <p>This is an automated daily summary from the LogisEdge Billing & Payable Tracking System.</p>
        <p>Report generated on {{ "now"|date:"F d, Y g:i A" }}</p>
        <p>For questions or support, contact the system administrator.</p>
    </div>
</body>
</html>